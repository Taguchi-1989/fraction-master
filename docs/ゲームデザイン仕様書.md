# 分数学習ゲーム「分数マスター」ゲームデザイン仕様書

## 1. ターゲット設定

### 1.1 主要ターゲット
- **年齢**: 6〜8歳（小学1〜2年生）
- **国語力**: 小学2年生程度（漢字はふりがな付きで積極的に使用）
- **数学レベル**: 分数の概念を学習中
- **デザインコンセプト**: 「お兄さん・お姉さんのゲーム」を触っている感覚

### 1.2 難易度調整機能（内部パラメータ）
```typescript
interface DifficultySettings {
  languageLevel: 'grade1' | 'grade2' | 'grade3';  // 言語レベル
  mathLevel: 'beginner' | 'intermediate' | 'advanced';  // 数学レベル
  hintFrequency: 'always' | 'sometimes' | 'rarely';  // ヒント頻度
  gameSpeed: 'slow' | 'normal' | 'fast';  // ゲームスピード
}
```

## 2. 言語・テキスト設計

### 2.1 文章表現ガイドライン

#### 使用する表現（小学中学年向け）
- ✅ 「挑戦（ちょうせん）してみよう」
- ✅ 「比較（ひかく）してみよう」
- ✅ 「正解（せいかい）です」
- ✅ 「もう一度考（かんが）えてみよう」
- ✅ 「次（つぎ）の問題（もんだい）へ進（すす）む」

#### 避ける表現（幼児向けすぎる）
- ❌ 「わかったかな？」
- ❌ 「すごいね〜」
- ❌ 「できたね！」
- ❌ 「がんばって！」

### 2.2 漢字使用ルール
```typescript
// 漢字変換テーブル（すべてふりがな付き）
const kanjiTable = {
  // 小学1年生の漢字
  '一': { reading: 'いち', grade: 1 },
  '二': { reading: 'に', grade: 1 },
  '三': { reading: 'さん', grade: 1 },
  
  // 小学2年生の漢字
  '分': { reading: 'ぶん', grade: 2 },
  '数': { reading: 'すう', grade: 2 },
  '半': { reading: 'はん', grade: 2 },
  '答': { reading: 'こた', grade: 2 },
  
  // 小学3年生の漢字（挑戦的に使用）
  '問題': { reading: 'もんだい', grade: 3 },
  '比較': { reading: 'ひかく', grade: 3 },
  '選択': { reading: 'せんたく', grade: 3 },
};
```

## 3. ビジュアルデザイン

### 3.1 カラーパレット
```css
:root {
  /* メインカラー（落ち着いた青系） */
  --primary-blue: #2563EB;      /* 深い青 */
  --primary-light: #60A5FA;     /* 明るい青 */
  
  /* アクセントカラー（知的な緑系） */
  --success-green: #10B981;     /* 成功・正解 */
  --hint-yellow: #F59E0B;       /* ヒント・注目 */
  
  /* ニュートラルカラー */
  --text-main: #1F2937;         /* メインテキスト */
  --text-sub: #6B7280;          /* サブテキスト */
  --background: #F9FAFB;        /* 背景 */
  
  /* 分数表示用 */
  --numerator: #2563EB;         /* 分子（青） */
  --denominator: #DC2626;       /* 分母（赤） */
  --fraction-line: #1F2937;     /* 分数線（黒） */
}
```

### 3.2 フォント設計
```css
/* フォント設定 */
body {
  font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic ProN', sans-serif;
  font-size: 16px;
  line-height: 1.6;
}

/* ふりがな表示 */
.kanji-with-furigana {
  display: inline-block;
  position: relative;
}

.furigana {
  position: absolute;
  top: -0.5em;
  left: 0;
  right: 0;
  text-align: center;
  font-size: 0.5em;
  color: var(--text-sub);
}

/* 分数表示 */
.fraction {
  display: inline-flex;
  flex-direction: column;
  align-items: center;
  font-size: 2rem;
  font-weight: bold;
  margin: 0 0.5rem;
}

.fraction-numerator {
  color: var(--numerator);
  border-bottom: 3px solid var(--fraction-line);
  padding-bottom: 0.2rem;
}

.fraction-denominator {
  color: var(--denominator);
  padding-top: 0.2rem;
}
```

### 3.3 UI要素デザイン

#### ボタンデザイン
```tsx
// components/ui/Button.tsx
const buttonVariants = {
  primary: 'bg-blue-600 hover:bg-blue-700 text-white shadow-lg',
  secondary: 'bg-gray-200 hover:bg-gray-300 text-gray-800',
  success: 'bg-green-500 hover:bg-green-600 text-white',
  hint: 'bg-yellow-500 hover:bg-yellow-600 text-white',
};

// 使用例
<Button variant="primary" size="large">
  <ruby>挑戦<rt>ちょうせん</rt></ruby>する
</Button>
```

## 4. 画面デザイン詳細

### 4.1 タイトル画面
```tsx
// 画面構成
<div className="min-h-screen bg-gradient-to-b from-blue-50 to-blue-100">
  <div className="container mx-auto px-4 py-16">
    {/* タイトル */}
    <h1 className="text-6xl font-bold text-center mb-8">
      <ruby>分数<rt>ぶんすう</rt></ruby>マスター
    </h1>
    
    {/* サブタイトル */}
    <p className="text-xl text-center text-gray-700 mb-12">
      <ruby>数<rt>かず</rt></ruby>の<ruby>世界<rt>せかい</rt></ruby>を
      <ruby>探検<rt>たんけん</rt></ruby>しよう
    </p>
    
    {/* スタートボタン */}
    <button className="mx-auto block px-12 py-6 text-2xl">
      ゲームを<ruby>開始<rt>かいし</rt></ruby>
    </button>
  </div>
</div>
```

### 4.2 レベル選択画面
```tsx
const levels = [
  {
    id: 'easy',
    title: '初級（しょきゅう）',
    description: '2分の1、3分の1など',
    color: 'bg-green-500',
    icon: '🌱',
  },
  {
    id: 'normal',
    title: '中級（ちゅうきゅう）',
    description: '6分の1、8分の1まで',
    color: 'bg-blue-500',
    icon: '🌿',
  },
  {
    id: 'hard',
    title: '上級（じょうきゅう）',
    description: '12分の1まで、速度（そくど）アップ',
    color: 'bg-purple-500',
    icon: '🌳',
  },
];
```

### 4.3 ゲーム画面レイアウト
```tsx
// ゲーム画面の構成
<div className="game-screen">
  {/* 上部: 問題文とスコア */}
  <header className="game-header">
    <div className="question-text">
      大きいほうを<ruby>選択<rt>せんたく</rt></ruby>してください
    </div>
    <div className="score-display">
      <ruby>得点<rt>とくてん</rt></ruby>: {score}
    </div>
  </header>
  
  {/* 中央: 分数カード */}
  <main className="game-main">
    <div className="cards-container">
      {options.map(option => (
        <FractionCard key={option.id} {...option} />
      ))}
    </div>
  </main>
  
  {/* 下部: タイマーとヒント */}
  <footer className="game-footer">
    <TimeBar remaining={timeRemaining} />
    <button className="hint-button">
      ヒントを<ruby>表示<rt>ひょうじ</rt></ruby>
    </button>
  </footer>
</div>
```

## 5. アニメーション仕様

### 5.1 カード選択アニメーション
```typescript
// Framer Motion設定
const cardAnimations = {
  hover: {
    scale: 1.05,
    boxShadow: '0 10px 30px rgba(0,0,0,0.2)',
    transition: { duration: 0.2 }
  },
  tap: {
    scale: 0.95,
    transition: { duration: 0.1 }
  },
  correct: {
    scale: [1, 1.2, 1],
    rotate: [0, 10, -10, 0],
    backgroundColor: ['#fff', '#10B981', '#fff'],
    transition: { duration: 0.6 }
  },
  incorrect: {
    x: [0, -10, 10, -10, 10, 0],
    transition: { duration: 0.4 }
  }
};
```

### 5.2 ヒントアニメーション
```typescript
// 分数の視覚化アニメーション
const hintAnimations = {
  // ケーキの切り分けアニメーション
  cakeSlice: {
    initial: { pathLength: 0, opacity: 0 },
    animate: { 
      pathLength: 1, 
      opacity: 1,
      transition: { duration: 1.5, ease: 'easeInOut' }
    }
  },
  
  // 液体の注ぎアニメーション
  liquidFill: {
    initial: { scaleY: 0, transformOrigin: 'bottom' },
    animate: { 
      scaleY: 1,
      transition: { duration: 2, ease: 'easeOut' }
    }
  },
  
  // 比較強調アニメーション
  compareHighlight: {
    animate: {
      boxShadow: [
        '0 0 0 0 rgba(59, 130, 246, 0)',
        '0 0 0 10px rgba(59, 130, 246, 0.3)',
        '0 0 0 20px rgba(59, 130, 246, 0)',
      ],
      transition: { duration: 1.5, repeat: 2 }
    }
  }
};
```

## 6. サウンドデザイン

### 6.1 BGM仕様
```typescript
const bgmSettings = {
  title: {
    tempo: 100,  // BPM
    mood: 'mysterious, inviting',
    instruments: 'piano, strings, glockenspiel',
    volume: 0.3
  },
  gameplay: {
    tempo: 120,
    mood: 'encouraging, focused',
    instruments: 'light percussion, synthesizer, bells',
    volume: 0.2
  },
  result: {
    tempo: 130,
    mood: 'celebratory, achievement',
    instruments: 'full orchestra, brass section',
    volume: 0.4
  }
};
```

### 6.2 効果音仕様
```typescript
const soundEffects = {
  // UI操作音
  buttonTap: { file: 'tap.mp3', volume: 0.5, pitch: 1.0 },
  cardSelect: { file: 'select.mp3', volume: 0.6, pitch: 1.1 },
  
  // ゲーム進行音
  correct: { file: 'correct.mp3', volume: 0.7, pitch: 1.2 },
  incorrect: { file: 'incorrect.mp3', volume: 0.4, pitch: 0.9 },
  
  // 特殊効果音
  hintOpen: { file: 'hint.mp3', volume: 0.5, pitch: 1.0 },
  levelUp: { file: 'levelup.mp3', volume: 0.8, pitch: 1.3 },
  timeWarning: { file: 'warning.mp3', volume: 0.6, pitch: 1.0 }
};
```

### 6.3 音声ガイド（ElevenLabs設定）
```typescript
const voiceSettings = {
  voiceId: 'Rachel',  // 落ち着いた女性の声
  stability: 0.75,    // 安定性
  similarity: 0.75,   // 類似性
  style: 0.3,         // スタイル強度
  speakingRate: 0.9,  // 話速（少しゆっくり）
};

const voiceLines = {
  welcome: '分数マスターへようこそ。一緒に数の世界を探検しましょう。',
  levelSelect: 'レベルを選択してください。',
  correct: '正解です。次の問題へ進みます。',
  incorrect: 'もう一度考えてみましょう。',
  hint: 'ケーキを見比べてみてください。どちらが大きいでしょうか。',
  timeUp: '時間です。結果を確認しましょう。',
  excellent: '素晴らしい成績です。',
};
```

## 7. レスポンシブデザイン

### 7.1 ブレークポイント
```css
/* Tailwind CSS カスタム設定 */
module.exports = {
  theme: {
    screens: {
      'xs': '480px',   // スマートフォン
      'sm': '640px',   // 小型タブレット
      'md': '768px',   // タブレット
      'lg': '1024px',  // 小型デスクトップ
      'xl': '1280px',  // デスクトップ
      '2xl': '1536px', // 大型デスクトップ
    }
  }
}
```

### 7.2 デバイス別最適化
```tsx
// スマートフォン向け
const MobileLayout = () => (
  <div className="grid grid-cols-2 gap-4 p-4">
    {/* カードを2列表示 */}
  </div>
);

// タブレット向け
const TabletLayout = () => (
  <div className="grid grid-cols-3 gap-6 p-6">
    {/* カードを3列表示 */}
  </div>
);

// デスクトップ向け
const DesktopLayout = () => (
  <div className="flex justify-center gap-8 p-8">
    {/* カードを横並び表示 */}
  </div>
);
```

## 8. アクセシビリティ対応

### 8.1 キーボード操作
```typescript
const keyboardShortcuts = {
  'Tab': '次の要素へ移動',
  'Shift+Tab': '前の要素へ移動',
  'Enter': '選択・決定',
  'Space': '選択・決定',
  'Escape': '戻る・キャンセル',
  'H': 'ヒント表示',
  '1-3': 'カード選択（左から順）',
};
```

### 8.2 ARIA属性
```tsx
<div 
  role="button"
  aria-label="分数カード：2分の1"
  aria-pressed={isSelected}
  tabIndex={0}
>
  {/* カード内容 */}
</div>
```

## 9. パフォーマンス最適化

### 9.1 画像最適化
- WebP形式を優先使用
- 適切なサイズでの画像提供
- 遅延読み込みの実装

### 9.2 アニメーション最適化
- GPU加速を活用（transform, opacity）
- will-changeの適切な使用
- 60FPSを維持

## 10. 今後の拡張機能

### 10.1 難易度カスタマイズ（保護者向け）
- 言語レベルの調整
- 数学レベルの調整
- ゲームスピードの調整
- ヒント頻度の調整

### 10.2 学習記録・分析
- 正答率の記録
- 苦手分野の特定
- 成長グラフの表示
- 学習レポートの生成