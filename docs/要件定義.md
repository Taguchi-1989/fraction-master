## 🎮 分数マスター 要件定義書 (v1.0.0)

### 1. ゲームの目的とコンセプト

* **目的**: 6歳児が**分数の基本概念**（分母・分子）と**量のイメージ**を直感的に理解し、算数への興味を持つきっかけを作ること。
* **コンセプト**: 「数えて理解、見て確認」をテーマに、SVG図形による分数視覚化と2段階ヒントシステムで、段階的に分数を学ぶ教育ゲーム。
* **実装バージョン**: 1.0.0（2025年8月リリース）- 全機能実装完了

---

### 2. ターゲットユーザー

* **年齢**: 6歳（小学校入学前）
* **スキル**:
    * ひらがなが読める。
    * 1から10までの数字がわかる。
    * 簡単なタップやドラッグ操作ができる。

---

### 3. ゲームの主な流れ

1.  **タイトル画面**
    * 「分数マスター」タイトルと「ゲームを開始」ボタンが表示
    * 制作者情報へのリンク
2.  **レベル選択画面**
    * 「初級」「中級」「上級」の3つのレベルから選択
    * **NEW:** 「遊び方」ボタンで詳細な説明ページへアクセス可能
3.  **遊び方説明画面** ⭐NEW⭐
    * 分数の基本概念（分母・分子）を視覚的に説明
    * 3/5の例で5本の長方形と3つ塗りつぶしによる直感的理解
    * ゲーム操作方法とスコアシステムの詳細説明
    * レベル別難易度の事前説明
4.  **ゲーム画面**
    * **5問固定**で問題が出題され、カードをタップして回答
    * **時間制限なし**でプレッシャーを軽減
    * **改善型2段階ヒントシステム**：
        * **第1段階**: 分数の数字と分母の構造（枠線）を常時表示
        * **第2段階**: 10秒後にヒントボタン有効化、押すと分子分の塗りつぶし表示
    * **戦略的スコアシステム**: ヒント未使用10点、使用時5点
    * **BGMと効果音**: music1.wavによるBGM、各種効果音
5.  **結果画面**
    * スコア・正答率・総時間・間違い問題の振り返り表示
    * **30点以上で音声褒賞**: speech.wavで「よくできたね」再生
6.  **クレジット画面** ⭐NEW⭐
    * 技術情報、開発方針、バージョン情報を表示
    * 完全無料・広告なしポリシーの明示

---

### 4. 各画面の詳細仕様

#### 4.1. タイトル画面
* **表示項目**:
    * ゲームタイトル: 『分数マスター』（ルビ付き）
    * サブタイトル: 「数の世界を探検しよう」
    * 「ゲームを開始」ボタン
    * 「制作者情報」ボタン
* **アクション**: 
    * 「ゲームを開始」→ レベル選択画面に移動
    * 「制作者情報」→ クレジット画面に移動

#### 4.2. レベル選択画面
* **表示項目**:
    * 「レベルを選択してください」メッセージ
    * レベル選択ボタン
        * **初級** 🌱: 2分の1、3分の1など基本分数
        * **中級** 🌿: 6分の1、8分の1までの中程度分数
        * **上級** 🌳: 複雑な分数の比較と等価問題
    * **「遊び方」ボタン**: 詳細説明ページへのアクセス
    * 「戻る」ボタン
* **アクション**: 
    * レベルボタン → ゲーム画面に移動
    * 遊び方ボタン → 遊び方説明画面に移動
    * 戻るボタン → タイトル画面に戻る

#### 4.3. ゲーム画面
* **レイアウト**:
    * **上部**: スコア、問題番号（○/5）、正解数を表示するヘッダー
    * **中央上**: 問題文エリア（ルビ対応）
    * **中央**: 2〜3枚の分数カードが表示される選択肢エリア
    * **下部**: ヒントボタン（カウントダウン表示）とゲーム終了ボタン
* **分数カードのデザイン**:
    * **改善型2段階表示システム**:
        * **初期状態**: 
            * 分数の数字表示
            * 分母の構造（枠線・分割線）を常時表示
            * 塗りつぶしは非表示
        * **ヒント使用後**: 
            * 10秒後にヒントボタン有効化
            * ボタン押下で分子分の塗りつぶし表示
    * **SVG視覚化**:
        * 円形（円グラフ）
        * 長方形（バー分割）
        * 液体（コップ内の量）
* **音響システム** ⭐NEW⭐:
    * **BGM**: music1.wav自動再生（ループ）
    * **効果音**: 正解音、不正解音、ヒント音、クリック音
* **戦略的スコアシステム** ⭐NEW⭐:
    * ヒント未使用正解: **10点**
    * ヒント使用正解: **5点**
    * 不正解: 0点
* **ゲームの進行**:
    1.  問題表示（構造のみ、塗りつぶしなし）
    2.  10秒カウントダウン後、ヒントボタン有効化
    3.  戦略的判断（ヒント使用の可否）
    4.  カード選択とフィードバック
    5.  1.5秒後に次問題へ自動進行
    6.  5問完了で結果画面へ移動

#### 4.4. 遊び方説明画面 ⭐NEW⭐
* **表示項目**:
    * **分数の基本概念説明**:
        * 1/2, 3/5, 2/3の視覚的例示
        * 分母（全体を何個に分けたか）と分子（そのうち何個取ったか）の説明
        * 5本の長方形で3つ塗りつぶし（3/5の例）による直感的理解
    * **ゲームの基本操作説明**:
        * 大きい分数のカードをタップ
        * 10秒後にヒントボタンが使える
        * 5問全部で終了
    * **得点システム説明**:
        * ヒントなし正解：10点
        * ヒントあり正解：5点
        * 間違い：0点
    * **レベル選択説明**:
        * 初級🌱：2分の1、3分の1など簡単な分数
        * 中級🌿：6分の1、8分の1まで少し複雑な分数
        * 上級🌳：複雑な分数の比較・等価問題も登場
    * **ヒント機能の詳細説明**:
        * 最初は数字と枠線だけ表示（分母を数える練習）
        * ヒントボタンで塗りつぶし表示（分子の分だけ色がつく）
* **アクション**:
    * レベル選択に戻るボタン
    * タイトル画面に戻るボタン

#### 4.5. 結果画面
* **表示項目**:
    * 「ゲーム終了」メッセージ
    * **詳細な成績表示**:
        * 最終スコア（戦略的スコアシステム反映）
        * 正解数 / 問題数
        * 正答率（%表示）
        * 総時間（秒単位）
    * **改善されたメッセージシステム**:
        * 問題未回答時: 「ゲームを途中で終了しました」
        * 全問不正解時: 「もう一度挑戦してみよう！」
        * 正答率90%以上: 「素晴らしい成績です！」
        * 正答率70%以上: 「よくできました！」
        * 正答率50%以上: 「がんばりました！」
    * **音声褒賞システム** ⭐NEW⭐:
        * 30点以上でspeech.wav「よくできたね」自動再生
    * **間違い問題振り返り**: ComparisonVisualizationによる比較学習
    * ナビゲーションボタン

#### 4.6. クレジット画面 ⭐NEW⭐
* **表示項目**:
    * **制作・開発情報**:
        * ZEAL BOOT CAMP制作表示
        * プログラミング教育を通じた子どもたちの学習支援方針
    * **技術情報**:
        * 使用技術スタック（React, Next.js, TypeScript, Tailwind CSS, Zustand）
        * 実装機能（SVG分数視覚化、段階的ヒント機能、間違い復習機能、レスポンシブ対応、問題プール管理）
    * **運用方針**:
        * 完全無料💝：すべての機能を無料で提供
        * 広告なし🚫：学習に集中できるよう広告は一切表示しない
        * 目的：子どもたちが楽しく分数を学べる環境を提供すること
    * **AI・プラットフォーム情報** ⭐NEW⭐:
        * Google Vertex AI音声合成システム
        * BGM自動生成技術
        * Vertex AI Text-to-Speech API使用
        * 生成音声・BGM（著作権フリー）
        * Web Audio API（再生制御）
        * 使用音声・BGM素材はすべてAI生成による著作権フリー素材
    * **配信情報**:
        * バージョン情報（package.jsonから動的取得）
        * Vercel静的サイト生成(SSG)による高速配信
        * 世界中どこからでも高速アクセス可能
* **アクション**:
    * タイトル画面に戻るボタン

---

### 5. ゲームの問題（ロジック）の例

#### レベル：かんたん
* **大きさ比べ**: 「1/2」と「1/3」のカードが出てきて、「おおきいのは どっち？」と問われる。
* **仲間はずれ**: 「1/2」「1/2」「1/4」のカードが出てきて、「ちがうのは どれ？」と問われる。

#### レベル：ふつう
* **同じもの探し**: 「1/2」という記号カードと、「2/4」の絵のカードが出てきて、「おなじ おおきさは どれ？」と問われる。
* **足し算のイメージ**: 「1/4のケーキ」と「1/4のケーキ」の絵を合わせると、どのカードと同じになるかを選ばせる。（選択肢に「1/2のケーキ」のカードがある）

---

### 6. UI/UXデザインのポイント

* **文字**: 子供向けの丸ゴシック体など、読みやすいフォントを使用する。**すべての漢字とカタカナにふりがなを振る**。**小学2年生レベルの国語力**を想定し、子供扱いしない適度な漢字使用。
* **色彩**: 
    * 明るく、彩度の高い色を基本とし、子供の注意を引く配色にする。
    * **文字の視認性向上**: 黒背景ではなく白背景を使用し、青系の文字色で見やすく表示。
* **プレッシャー軽減の工夫**:
    * **時間制限を撤廃**し、じっくり考えられる環境を提供。
    * **段階的学習支援**で無理なく理解を深められる。
* **アニメーション**:
    * カードをタップした時の反応（少し大きくなるなど）を付ける。
    * 正解時・不正解時の視覚的フィードバック（緑・赤の境界線表示）。
    * **過度にうるさくない**適度なアニメーションで集中を妨げない。
* **学習支援機能**:
    * **改善型2段階ヒントシステム**:
        * 第1段階：分母の構造（何個に分けられているか）を常に表示し、数を数える練習をサポート
        * 第2段階：ヒントボタンで塗りつぶしを表示し、量のイメージを強化
    * **振り返り機能**で間違えた問題を復習可能。

---

### 7. 技術要件（v1.0.0実装済み）

* **開発技術スタック** ⭐実装完了⭐: 
    * **フロントエンド**: React 19.1.0 + Next.js 15.4.6 (App Router) + TypeScript 5.x
    * **スタイリング**: Tailwind CSS 4.x（CSS transitionsでアニメーション）
    * **状態管理**: Zustand 5.0.7
    * **音響**: Web Audio API（BGM・効果音管理）
    * **AI音声生成**: Google Vertex AI Text-to-Speech API
    * **デプロイ**: Vercel SSG (Static Site Generation)
* **実装済み機能アーキテクチャ**:
    * **SVG分数視覚化**: 動的パス生成による高精度表示
    * **2段階ヒントシステム**: showFilled パラメータによる段階制御
    * **戦略的スコアリング**: Zustandストアでの状態管理
    * **音響管理**: AudioManagerクラスによる一元管理
    * **レスポンシブ対応**: Tailwind CSSによるマルチデバイス対応
* **実行環境**: PC、スマートフォン、タブレットのモダンウェブブラウザ
* **運用方針**: **完全無料・広告なし**での提供

---

### 8. v1.0.0実装完了機能（2025年8月リリース）

#### 8.1. コア教育機能
* **改善型2段階ヒントシステム**: 分母構造→塗りつぶしの段階的理解
* **分数基本概念説明**: 遊び方ページでの分母・分子視覚的説明
* **戦略的学習促進**: ヒント使用判断による能動的学習
* **時間プレッシャー排除**: 制限時間なしでの安心学習環境

#### 8.2. ユーザー体験向上
* **包括的チュートリアル**: HowToPlayScreenによる事前説明
* **音響フィードバック**: BGM・効果音・音声褒賞による没入感
* **明確な進捗管理**: 5問固定・リアルタイムスコア表示
* **学習支援機能**: 間違い問題の振り返りと比較学習

#### 8.3. 技術的成果
* **レスポンシブ対応**: 全デバイス対応の統一UI/UX
* **アクセシビリティ**: ルビ機能による読みやすさ向上
* **パフォーマンス最適化**: Vercel SSGによる高速配信
* **バージョン管理**: package.jsonからの動的バージョン表示

#### 8.4. 教育効果検証
* **段階的理解促進**: 数える→見る→理解の学習フロー確立
* **自己調整学習**: ヒント使用タイミングの戦略的判断
* **復習機能**: 間違い問題の詳細分析による理解深化
* **達成感の創出**: 音声褒賞・段階的スコアリングによる学習動機向上

---

## 🚀 v1.0.0開発完了（2025年8月16日）

**開発者**: ZEAL BOOT CAMP  
**技術スタック**: React 19.1.0 + Next.js 15.4.6 + TypeScript + Tailwind CSS + Zustand  
**配信**: Vercel SSG  
**方針**: 完全無料・広告なし教育ゲーム  

この要件定義に基づく全機能実装が完了し、6歳児向け分数学習ゲーム「分数マスター」として正式リリースされました。段階的ヒントシステム、戦略的スコアリング、包括的説明機能により、効果的な分数学習環境を提供しています。